<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.0.76"/><style data-styled="cEBkMf gqwQqo hAazOm eQyeOI VeZlH kkqdts fqqaVC mQPfw jZhkXs bfwZCb fJCzJc jeGaYX jNiOmO iwuDfh hUCjEq hWflyi jIFvbx fZDpkr lddhRw bSWVxc" data-styled-version="4.1.3">
/* sc-component-id: Link__StyledGatsbyLink-jyt87h-0 */
.iwuDfh{color:#0a517b;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #0a517b;} .iwuDfh:hover,.iwuDfh:focus{border-bottom:1px dashed #0a517b;color:#0a517b;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: Link__RegularLink-jyt87h-1 */
.fJCzJc{color:#0a517b;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #0a517b;} .fJCzJc:hover,.fJCzJc:focus{border-bottom:1px dashed #0a517b;color:#0a517b;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: Bio__BioContainer-rj3ut0-0 */
.hUCjEq{display:grid;grid-gap:10px;grid-template-columns:50px 1fr;}
/* sc-component-id: Box-sc-172hg9r-0 */
.jZhkXs{margin-bottom:25px;margin-top:25px;}
/* sc-component-id: sc-global-631278321 */
*{margin:0;padding:0;box-sizing:border-box;} img{border:0;max-width:100%;} h1,h2,h3,h4{font-weight:bold;} html{height:100%;} body{color:#444;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen", "Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue", sans-serif;height:100%;line-height:1.6;} code[class*="language-"],pre[class*="language-"]{color:white;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;} pre[class*="language-"]{overflow:auto;padding:1em;} pre[class*="language-"]::-moz-selection{background:hsl(207,4%,16%);} pre[class*="language-"]::selection{background:hsl(207,4%,16%);} pre[class*="language-"]::-moz-selection,pre[class*="language-"] ::-moz-selection{text-shadow:none;background:hsla(0,0%,100%,0.15);} pre[class*="language-"]::selection,pre[class*="language-"] ::selection{text-shadow:none;background:hsla(0,0%,100%,0.15);} :not(pre) > code[class*="language-"]{border-radius:.3em;background:rgba(255,229,100,0.2);color:#1a1a1a;padding:.15em .2em .05em;white-space:normal;} .token.attr-name{color:rgb(173,219,103);font-style:italic;} .token.comment{color:rgb(99,119,119);} .token.string,.token.url{color:rgb(173,219,103);} .token.variable{color:rgb(214,222,235);} .token.number{color:rgb(247,140,108);} .token.builtin,.token.char,.token.constant,.token.function{color:rgb(130,170,255);} .token.punctuation{color:rgb(199,146,234);} .token.selector,.token.doctype{color:rgb(199,146,234);font-style:'italic';} .token.class-name{color:rgb(255,203,139);} .token.tag,.token.operator,.token.keyword{color:#ffa7c4;} .token.boolean{color:rgb(255,88,116);} .token.property{color:rgb(128,203,196);} .token.namespace{color:rgb(178,204,214);} pre[data-line]{padding:1em 0 1em 3em;position:relative;} .gatsby-highlight-code-line{background-color:hsla(207,95%,15%,1);display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:0.75em;border-left:0.25em solid #ffa7c4;} .gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#16191d;-webkit-overflow-scrolling:touch;overflow:auto;} .gatsby-highlight pre[class*="language-"]{float:left;min-width:100%;}
/* sc-component-id: Layout__VisuallyHidden-sc-11zbcp0-0 */
.jIFvbx{border:0;-webkit-clip:rect(0 0 0 0);clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}
/* sc-component-id: Layout__DarkContainer-sc-11zbcp0-1 */
.gqwQqo{background-color:#293139;}
/* sc-component-id: Layout__Heading-sc-11zbcp0-2 */
.hAazOm{font-size:20px;margin:0 auto;max-width:780px;}
/* sc-component-id: Layout__HeaderLink-sc-11zbcp0-3 */
.eQyeOI{border:none;color:#fff;display:block;padding:5px 20px;-webkit-text-decoration:none;text-decoration:none;} .eQyeOI:hover{-webkit-text-decoration:underline;text-decoration:underline;}
/* sc-component-id: Layout__Footer-sc-11zbcp0-4 */
.hWflyi{margin:0 auto;max-width:780px;}
/* sc-component-id: Layout__FooterList-sc-11zbcp0-5 */
.fZDpkr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;list-style-type:none;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}
/* sc-component-id: Layout__FooterLink-sc-11zbcp0-6 */
.bSWVxc{border:none;color:#fff;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #fff;} .bSWVxc:focus,.bSWVxc:hover{border-bottom:1px dashed #fff;}
/* sc-component-id: Layout__FooterItem-sc-11zbcp0-7 */
.lddhRw{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:10px;} .lddhRw:not(:last-child)::after{content:'/';color:rgba(255,255,255,0.3);margin-left:20px;}
/* sc-component-id: Layout__Main-sc-11zbcp0-8 */
.cEBkMf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}
/* sc-component-id: Layout__Content-sc-11zbcp0-9 */
.VeZlH{-webkit-flex:1;-ms-flex:1;flex:1;margin:0 auto 25px;max-width:780px;padding:0 20px;}
/* sc-component-id: blog-post__Date-sc-1pfh6r7-0 */
.fqqaVC{color:#999;}
/* sc-component-id: blog-post__PostHeading-sc-1pfh6r7-1 */
.kkqdts{color:#293139;padding:20px 0;font-size:35px;} @media (min-width:700px){.kkqdts{padding:40px 0;font-size:40px;}}
/* sc-component-id: blog-post__Hr-sc-1pfh6r7-2 */
.jeGaYX{background:hsla(0,0%,0%,0.2);border:none;margin:0;margin-bottom:calc(1.75rem - 1px);padding:0;height:1px;}
/* sc-component-id: blog-post__MarkdownStyles-sc-1pfh6r7-3 */
.mQPfw a{color:#0a517b;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #0a517b;} .mQPfw a:hover,.mQPfw a:focus{border-bottom:1px dashed #0a517b;color:#0a517b;-webkit-text-decoration:none;text-decoration:none;} .mQPfw ul{list-style-type:disc;} .mQPfw ul,.mQPfw ol{margin:1.2em 0 1.2em 2.3em;} .mQPfw p{margin:1.2em 0;} .mQPfw blockquote{font-style:italic;padding:0 3em;} .mQPfw pre{overflow:auto;}
/* sc-component-id: blog-post__NextPreviousList-sc-1pfh6r7-4 */
.jNiOmO{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style-type:none;}
/* sc-component-id: blog-post__Twitter-sc-1pfh6r7-5 */
.bfwZCb{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#1b95e0;border:none;border-radius:4px;color:#fff;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;font-size:13px;font-weight:500;height:20px;padding:15px 10px;-webkit-text-decoration:none;text-decoration:none;} .bfwZCb:hover,.bfwZCb:focus{background-color:#0c7abf;border:none;color:#fff;} .bfwZCb:active{box-shadow:inset 0 3px 7px rgba(0,0,0,0.1);} .bfwZCb::before{background:transparent 0 0 no-repeat;background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2072%2072%22%3E%3Cpath%20fill%3D%22none%22%20d%3D%22M0%200h72v72H0z%22%2F%3E%3Cpath%20class%3D%22icon%22%20fill%3D%22%23fff%22%20d%3D%22M68.812%2015.14c-2.348%201.04-4.87%201.744-7.52%202.06%202.704-1.62%204.78-4.186%205.757-7.243-2.53%201.5-5.33%202.592-8.314%203.176C56.35%2010.59%2052.948%209%2049.182%209c-7.23%200-13.092%205.86-13.092%2013.093%200%201.026.118%202.02.338%202.98C25.543%2024.527%2015.9%2019.318%209.44%2011.396c-1.125%201.936-1.77%204.184-1.77%206.58%200%204.543%202.312%208.552%205.824%2010.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163%200%206.345%204.513%2011.638%2010.504%2012.84-1.1.298-2.256.457-3.45.457-.845%200-1.666-.078-2.464-.23%201.667%205.2%206.5%208.985%2012.23%209.09-4.482%203.51-10.13%205.605-16.26%205.605-1.055%200-2.096-.06-3.122-.184%205.794%203.717%2012.676%205.882%2020.067%205.882%2024.083%200%2037.25-19.95%2037.25-37.25%200-.565-.013-1.133-.038-1.693%202.558-1.847%204.778-4.15%206.532-6.774z%22%2F%3E%3C%2Fsvg%3E);content:' ';height:18px;margin-right:8px;width:18px;}</style><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><title data-react-helmet="true">Loading Everything at Once - HTML, CSS &amp; JavaScript | Christian Vuerings</title><meta data-react-helmet="true" name="description" content="Some Sakai3 front-end developers had a dream: For our widget loading mechanism we want to load the HTML / CSS and JavaScript in one request (without asking the…"/><meta data-react-helmet="true" property="og:title" content="Loading Everything at Once - HTML, CSS &amp; JavaScript"/><meta data-react-helmet="true" property="og:description" content="Some Sakai3 front-end developers had a dream: For our widget loading mechanism we want to load the HTML / CSS and JavaScript in one request (without asking the…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Christian Vuerings"/><meta data-react-helmet="true" name="twitter:title" content="Loading Everything at Once - HTML, CSS &amp; JavaScript"/><meta data-react-helmet="true" name="twitter:description" content="Some Sakai3 front-end developers had a dream: For our widget loading mechanism we want to load the HTML / CSS and JavaScript in one request (without asking the…"/><link as="script" rel="preload" href="/1-80129e349bf743aad75d.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-dd621388e01b48eb9180.js"/><link as="script" rel="preload" href="/0-bba33937ad4c3962d12b.js"/><link as="script" rel="preload" href="/app-632492d5be46657f0eac.js"/><link as="script" rel="preload" href="/webpack-runtime-97edc319aa4eb7cdbad9.js"/><link as="fetch" rel="preload" href="/static/d/26/path---loading-everything-at-once-javascript-html-css-ef-1-efa-zrSc1eYryx6jKqII3WtbZkALnQE.json" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="Layout__Main-sc-11zbcp0-8 cEBkMf"><div class="Layout__DarkContainer-sc-11zbcp0-1 gqwQqo"><h1 class="Layout__Heading-sc-11zbcp0-2 hAazOm"><a class="Layout__HeaderLink-sc-11zbcp0-3 eQyeOI" href="/">Christian Vuerings</a></h1></div><div class="Layout__Content-sc-11zbcp0-9 VeZlH"><h1 class="blog-post__PostHeading-sc-1pfh6r7-1 kkqdts">Loading Everything at Once - HTML, CSS &amp; JavaScript</h1><p class="blog-post__Date-sc-1pfh6r7-0 fqqaVC">April 25, 2010</p><div class="blog-post__MarkdownStyles-sc-1pfh6r7-3 mQPfw"><div><p>Some Sakai3 front-end developers had a dream:</p>
<blockquote>
<p>For our widget loading mechanism we want to load the HTML / CSS and JavaScript in one request (without asking the user to use inline CSS or JavaScript)</p>
</blockquote>
<p>It felt like quite a big challenge and I wondered if it would be possible from a front-end point of view or not. So I <a href="https://christianvuerings.github.io/everythingatonce/">gave it a go</a>.</p>
<h3>What we need from the back-end</h3>
<p>In Nakamura (the Sakai3 back-end) we are using <a href="https://sling.apache.org/site/index.html">Apache Sling</a> in combination with <a href="https://jackrabbit.apache.org/">Apache Jackrabbit</a>. Which means that when we go to a URL like twitter.2.json we get information back about the structure of it’s contents:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
    <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
    <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
    <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"sling:Folder"</span><span class="token punctuation">,</span>
    <span class="token string">"css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"sling:Folder"</span><span class="token punctuation">,</span>
        <span class="token string">"twitter.css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"nt:file"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"javascript"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"sling:Folder"</span><span class="token punctuation">,</span>
        <span class="token string">"twitter.js"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"nt:file"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"twitter.html"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"jcr:createdBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:created"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:08:18 GMT+0100"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"nt:file"</span><span class="token punctuation">,</span>
        <span class="token string">"jcr:content"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"jcr:lastModifiedBy"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>
            <span class="token string">":jcr:data"</span><span class="token punctuation">:</span> <span class="token number">2465</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:primaryType"</span><span class="token punctuation">:</span> <span class="token string">"nt:resource"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:uuid"</span><span class="token punctuation">:</span> <span class="token string">"65305673-e757-4ff8-a62a-26f10b11a020"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:mimeType"</span><span class="token punctuation">:</span> <span class="token string">"text/html"</span><span class="token punctuation">,</span>
            <span class="token string">"jcr:lastModified"</span><span class="token punctuation">:</span> <span class="token string">"Mon Apr 19 2010 11:07:54 GMT+0100"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>If we remove all the “jcr:” properties on those nodes, it makes it even more clear:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
    <span class="token string">"css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"twitter.css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"javascript"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"twitter.js"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"twitter.html"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>We basically get the hierarchical folder structure back for the twitter widget. If we change default GET servlet for sling or if we make a URL to something like twitter.content.json, it would be possible to get something like this back:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
    <span class="token string">"css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"twitter.css"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"body {background:#000000}"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"javascript"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"twitter.js"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"alert(\"loaded\");"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"twitter.html"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"&lt;!DOCTYPE html>&lt;html lang=\"en\">&lt;head>&lt;meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\">&lt;title>Loaded page&lt;/title>&lt;link rel=\"stylesheet\" href=\"css/twitter.css\" type=\"text/css\" />&lt;script type=\"text/javascript\" src=\"javascript/twitter.js\">&lt;/script>&lt;/head>&lt;body>&lt;h1>Testing whether this could actually work&lt;/h1>&lt;/body>&lt;/html>"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And that, would be genuinely awesome. This would mean that our widget could be loaded into one request! Except for the images – but those could get base64 encoded…</p>
<h3>About the example</h3>
<p>Before I send a request to the back-end to have this feature enabled, I want to make sure that we could actually make it work in cross-browser, fast and easy to use way.</p>
<p>Basically a Sakai3 page process looks like this:</p>
<ol>
<li>Load a Sakai3 page with all it’s resources (HTML / CSS / JavaScript / Images)</li>
<li>When this page is loaded, load all the widgets you embedded on that page.</li>
</ol>
<p>The Sakai3 widget process goes a bit deeper:</p>
<ol>
<li>For each widget type, send one GET request to it’s path. (e.g. devwidgets/twitter.3.json)</li>
<li>Run over all the properties in that file and divide it into 3 sections: HTML / CSS and JavaScript.</li>
<li>Save those 3 sections in separate objects / arrays in the JavaScript memory.</li>
<li>Remove the original &#x3C;link> and &#x3C;script> tags from the widget HTML.</li>
<li>Add the widget HTML to the container on the Sakai3 page.</li>
<li>Load the CSS and JavaScript dynamically without doing an extra request.</li>
</ol>
<p>So instead of doing a request to an <a href="https://christianvuerings.github.io/everythingatonce/loaded.html">HTML file</a>, a <a href="https://christianvuerings.github.io/everythingatonce/css/loaded.css">CSS file</a> and a <a href="https://christianvuerings.github.io/everythingatonce/javascript/loaded.js">JavaScript file</a>, we would just make one request to a <a href="https://christianvuerings.github.io/everythingatonce/json/widget.json">JSON file</a>.</p>
<p><a href="./2010-04-25-perf1_b.png">
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block;  max-width: 300px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsSAAALEgHS3X78AAAAeElEQVQI1xXGQQ6CMBBAUe6/8SImxoS40CVdVB2CUuzAOO1oadJaPYTwFj+/EvG3bpVSHhFTzsystRbv+4etAa507FpDRONbDQatcSHE8im/b6mcc6pRixjj8muZWwBE7M3g51nC8yWBvT3dN/vdod42lzOgRZqmPwzCZAc3PaE8AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Doing the requests separately"
        title=""
        src="/static/b45f7ec554a5713f7684248c0ff3d3b4/56ac3/2010-04-25-perf1.png"
        srcset="/static/b45f7ec554a5713f7684248c0ff3d3b4/3dd37/2010-04-25-perf1.png 148w,
/static/b45f7ec554a5713f7684248c0ff3d3b4/3dede/2010-04-25-perf1.png 295w,
/static/b45f7ec554a5713f7684248c0ff3d3b4/56ac3/2010-04-25-perf1.png 300w"
        sizes="(max-width: 300px) 100vw, 300px"
      />
    </span>
  </span>
  </a></p>
<p>vs.</p>
<p><a href="./2010-04-25-perf2_b.png">
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block;  max-width: 300px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 1.6666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAIAAABR8BlyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAN0lEQVQI12M4c/bM+bPnz5w6f+H8hUuXLj148OjDh/e3b90+ffLU7dt3Pn369O7du/dgAGfAAQAhnzURxDCFkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="Doing everything in one request"
        title=""
        src="/static/f3834399e740aaa15566c67758c9731b/56ac3/2010-04-25-perf2.png"
        srcset="/static/f3834399e740aaa15566c67758c9731b/3dd37/2010-04-25-perf2.png 148w,
/static/f3834399e740aaa15566c67758c9731b/3dede/2010-04-25-perf2.png 295w,
/static/f3834399e740aaa15566c67758c9731b/56ac3/2010-04-25-perf2.png 300w"
        sizes="(max-width: 300px) 100vw, 300px"
      />
    </span>
  </span>
  </a></p>
<p>Too be honest I got everything working quite fast (+/- 1,5 hour) but it took a bit longer to make everything cross-browser. Especially the last part, loading the JavaScript and CSS dynamically.</p>
<p>I knew jQuery just recently added the <a href="https://api.jquery.com/jQuery.getScript/">$.getScript</a> but that added an extra Ajax call which I wanted to avoid in the first place. After lurking through the jQuery API and <a href="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js">source code</a>, I found out that the <a href="https://api.jquery.com/jQuery.globalEval/">$.globalEval</a> function did exactly what I wanted for the JavaScript part.</p>
<p>Maybe I didn’t look well enough, but I actually couldn’t find any native jQuery method that would load the CSS dynamically. So I wrote something that is heavily based on <a href="https://www.phpied.com/dynamic-script-and-style-elements-in-ie/">a post</a> by <a href="https://www.phpied.com/">Stoyan Stephanov</a>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> head <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> tag <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"&lt;link/>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tag<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span>attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>tagname <span class="token operator">===</span> <span class="token string">"style"</span> <span class="token operator">&amp;&amp;</span> tag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>styleSheet<span class="token punctuation">)</span><span class="token punctuation">{</span>
    tag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>styleSheet<span class="token punctuation">.</span>cssText <span class="token operator">=</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    tag<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>tag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>All the code that I wrote so far is pretty much WIP and in non-development ready state. For instance at the moment I load all the CSS/JavaScript files I get back from the JSON where I should only use the ones defined in the HTML. That and some other little things still need to be fixed. But those are minor things though and I definitely think I have an awesome proof of concept.</p></div></div><div class="Box-sc-172hg9r-0 jZhkXs"><a href="https://twitter.com/share?original_referer=undefined/loading-everything-at-once-javascript-html-css/&amp;amp;url=undefined/loading-everything-at-once-javascript-html-css/&amp;amp;text=Loading Everything at Once - HTML, CSS %26 JavaScript&amp;amp;via=christianvuerings" target="_blank" class="blog-post__Twitter-sc-1pfh6r7-5 bfwZCb Link__RegularLink-jyt87h-1 fJCzJc">Tweet</a></div><hr class="blog-post__Hr-sc-1pfh6r7-2 jeGaYX"/><div class="Box-sc-172hg9r-0 jZhkXs"><ul class="blog-post__NextPreviousList-sc-1pfh6r7-4 jNiOmO"><li></li><li><a rel="next" class="Link__StyledGatsbyLink-jyt87h-0 iwuDfh" href="/hacking-around-with-userscripts/">Hacking Around With Userscripts<!-- --> →</a></li></ul></div><div class="Box-sc-172hg9r-0 jZhkXs"><div class="Bio__BioContainer-rj3ut0-0 hUCjEq"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-bottom:0;min-width:50px;border-radius:100%"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAFR0lEQVQ4y1WUeUxUVxTGHxWpLNalLKKWguioKDCDMOxbwYKFgakICggykYpSRFFEg1A0alK1uGCl0kbT2MRGEdRqXELTpIl/aFqr1mABYWbe7DvL4NY33K/3DQ5Jb/Ll3tzc83vnu+e8y7AGG8MPpd7KqIzD771beyq0lo1ynfmqymBhtXoLp5kUS9VFVU7lxZ9VaU1uap3ZyXDNPMCNeTfkGlORXGseNI2+gWnsDdQmG9QGKzTGYejNIxgdf+uU1mAdoip2xVGY21RmrqHQWU5Y7P/CMPwSFMop9FZObRmd0OqMRKfSEJ3RTDQGC0eDObPN7gTT9WlXPM2WmbKpNo2ceDkB6K1jDp1l1KG12smQUkt6bvaQ1rOdpLXtCvm15yGRy9WE1ZkJDXZQceOvJ0Dntv9lSWFFw68c0FrGHHrb6IR57DUe9Q6S1n0HSdOWXSivOYjyih3YXtuCmxd/hvLxIyLXmqDUmyjcxI3Y34LeaYkTNsDqPanVQZ1tnB6wOqhgsr8hh74+i7WpEuSlZWNp4DzM8ZiOWVRhQcE419wEVq4iGtMwD3KYrHbeukKpNngzg2rjRj29MzpzL1QGojJYyYNnA4hLXYvoZSLMm+mDyPl+SFsSBPHHgQj08Yaftw9uXL0Ok81OWI2Rt8zZRl+BAisYCrnqAvYr9fxXyeU7v0MgECJzRTBSBB8hlcI2xYZDGiGAODgQ/u4MGnbshm30NVGo9DyUs47QQrK6bt4ySysKOk/0yTVEYx7D9xd+QqIgCK2b8lC3OgFlsRE4tV6CA59/isqUKHRUF6Dz4nmwOgvNygl0GGhLUeATpk+hpZnpQEUG1EbS1z+Ew+tzIBUuwqX6rfiuvBC16fE4VvQZOnfKcLexGvb7l3G5pQZyhQYKtYEoJ7PkgWO0D0c4ucZMgVryQmUk/XI1LlTLsC87Dme2FKI+Kx6ypBjsXZ2IW/u342SZBL0dTXjQsp0WRo0hCqMg3jpom9mZzlud7J/P+2iFbaRfoSEstfzbnXuoTovG4bI12FeQil2fxOPKzi9wu6UO7VX56D3/FbRP/gDtDrA0QwWrc1l+ysTET+sqq0zGtbt3uQFa5QGW2mf1ONd2BnXSdOwpzMSxYimOS7Kg6PoBzy8dxoPrP0Jve4UX1NVfz/4hA/y1yTX4u3egmxGtmlOenOaJHOli7tqdW0RtGidynY3vK7RsLkZRYiSOydbh9pF6aO9dxP2OZhxt3Iue+49x7ZcbpLJKhnxpJldSkoHGphoZ479ggVeEyGuIZoq8wnBHQ/M2tHW0Ef5e2/fvRn70MqyNj0RNbhpaa0rQuC4FUaJ0FNSeJEmxSxEmCHAIQmZDtHK2MmAO4+P8W0JD5hZHhPtCFO3Bpab7kvJyCbIlUrJ5TTpppBXPFi1DdLA/duTEIS8qjAizviSJleeRuiafJIkDuOTYEKTEB5c5YSErGecPLY71PZ2SHoqoxAQuYOESB92CRBxJTm8tJXukWWRbVhLZnZtKVoVFkdCMWohLTzliNxzlEgrqkJxb2s4zKr556MYkJQunnq+AxdFtHrMXwcdrFtzdZ3BJYaFce3Wp48CGPNJclEtyxULHzPlCbmXOXk4oPYCQlGr4Rmxod8WLJTsnX5uYmKVTD+ysmR+UeL0/QzFt2nQsXxiI45sLcKhEgoaCbPjN9ceHSzKwIrsewYmVyoXijWWuuIjMyklGYlLIJDQhjImN8HZuBgYEeXu4e1R4zfDslsStelKVkzmWIVxh9/Dye7pAVNC9OKVK5rs8x1mA/Lout/CcBmdcmuxb5j80tKmPPzXf+wAAAABJRU5ErkJggg==" alt="Christian Vuerings" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition:opacity 0.5s;transition-delay:0.25s"/><noscript><picture><source srcSet="/static/c4ae59ff927099d0a303d6974302c439/66382/profile-picture.png 1x,
/static/c4ae59ff927099d0a303d6974302c439/18a61/profile-picture.png 1.5x,
/static/c4ae59ff927099d0a303d6974302c439/f52d2/profile-picture.png 2x,
/static/c4ae59ff927099d0a303d6974302c439/4ffea/profile-picture.png 3x" /><img width="50" height="50" src="/static/c4ae59ff927099d0a303d6974302c439/66382/profile-picture.png" alt="Christian Vuerings" style="position:absolute;top:0;left:0;transition:opacity 0.5s;transition-delay:0.5s;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><div>Personal blog by<!-- --> <a href="https://twitter.com/christianvuerings" class="Link__RegularLink-jyt87h-1 fJCzJc">Christian Vuerings</a><br/>I love to share interesting ideas.</div></div></div></div><div class="Layout__DarkContainer-sc-11zbcp0-1 gqwQqo"><footer class="Layout__Footer-sc-11zbcp0-4 hWflyi"><div class="vcard"><div class="Layout__VisuallyHidden-sc-11zbcp0-0 jIFvbx"><h2>Contact details</h2></div><ul class="Layout__FooterList-sc-11zbcp0-5 fZDpkr"><li class="Layout__FooterItem-sc-11zbcp0-7 lddhRw"><a href="https://twitter.com/christianvuer" title="Christian&#x27;s twitter page" target="_blank" class="Layout__FooterLink-sc-11zbcp0-6 bSWVxc">Twitter</a></li><li class="Layout__FooterItem-sc-11zbcp0-7 lddhRw"><a href="https://github.com/christianvuerings" title="Have a peek at Christian&#x27;s github repositories" target="_blank" class="Layout__FooterLink-sc-11zbcp0-6 bSWVxc">GitHub</a></li><li class="Layout__FooterItem-sc-11zbcp0-7 lddhRw"><a href="https://www.linkedin.com/in/christianvuerings" title="Contact Christian for business enquiries" target="_blank" class="Layout__FooterLink-sc-11zbcp0-6 bSWVxc">LinkedIn</a></li></ul></div></footer></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-190225-7', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"loading-everything-at-once-javascript-html-css-ef1","path":"/loading-everything-at-once-javascript-html-css/"};window.dataPath="26/path---loading-everything-at-once-javascript-html-css-ef-1-efa-zrSc1eYryx6jKqII3WtbZkALnQE";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-632492d5be46657f0eac.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-302b2f1c7106d1597605.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-dd621388e01b48eb9180.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c409471bd8c6328a8d1d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-eea2cba4274e21be54ac.js"],"pages-manifest":["/pages-manifest-f7ce15f391bbb0c8dbdb.js"]};/*]]>*/</script><script src="/webpack-runtime-97edc319aa4eb7cdbad9.js" async=""></script><script src="/app-632492d5be46657f0eac.js" async=""></script><script src="/0-bba33937ad4c3962d12b.js" async=""></script><script src="/component---src-templates-blog-post-js-dd621388e01b48eb9180.js" async=""></script><script src="/1-80129e349bf743aad75d.js" async=""></script></body></html>